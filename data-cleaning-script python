# data_cleaning.py

import pandas as pd

def clean_data(input_file, output_file):
    # Load data from CSV
    df = pd.read_csv(input_file)

    # Drop rows where all elements are missing
    df.dropna(how='all', inplace=True)

    # Fill missing values in 'Age' column with the average age
    if 'Age' in df.columns:
        mean_age = df['Age'].mean()
        df['Age'].fillna(mean_age, inplace=True)

    # Convert 'Date' column to datetime format if exists
    if 'Date' in df.columns:
        df['Date'] = pd.to_datetime(df['Date'], errors='coerce')

    # Remove duplicates
    df.drop_duplicates(inplace=True)

    # Save cleaned data to a new CSV file
    df.to_csv(output_file, index=False)
    print(f"Cleaned data saved to {output_file}")

if __name__ == "__main__":
    # Example usage
    input_csv = "raw_data.csv"
    output_csv = "cleaned_data.csv"
    clean_data(input_csv, output_csv)
